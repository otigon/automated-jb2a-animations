<div class='aa-autorecognition'>
    {{#each settings.aaAutorec.templates as |templates idx|}}
    <div class='aa-border-autorecog aa-search aaFGimage'>
        <div class='flexrow templates-settings' data-idx="{{idx}}">
            {{#if ( lookup (lookup ../settings.aaAutorec.templates idx) 'hidden' )}}
            <div class='flexcol'>
                <div class='form-group'>
                    <div class='form-fields'>
                        <input type='checkbox' class='hideme' name='aaAutorec.templates.{{idx}}.hidden' {{checked
                            (lookup (lookup ../settings.aaAutorec.templates idx) 'hidden' ) }} style="display:none">
                        <div class="aaToolTip" style="max-width: 1.5rem;margin-left: .75rem;"><i {{#if ( lookup (lookup
                                ../settings.aaAutorec.templates idx) 'hidden' ) }} class="fas fa-plus collapse-button"
                                {{/if}} {{#unless ( lookup (lookup ../settings.aaAutorec.templates idx) 'hidden' ) }}
                                class="fas fa-minus collapse-button" {{/unless}}></i>
                            <span class='aaToggle01'>
                                {{#if (lookup (lookup ../settings.aaAutorec.templates idx) 'hidden')}}
                                {{localize 'AUTOANIM.expand'}}
                                {{/if}}
                                {{#unless (lookup (lookup ../settings.aaAutorec.templates idx) 'hidden')}}
                                {{localize 'AUTOANIM.collapse'}}
                                {{/unless}}
                            </span>
                        </div>
                        <input type='text' name="aaAutorec.templates.{{idx}}.name"
                            placeholder="{{localize 'AUTOANIM.itemName'}}" class='auto-name'
                            value="{{lookup (lookup ../settings.aaAutorec.templates idx) 'name'}}" />
                        <div class="aaToolTip" style="max-width: 1.5rem;margin-left: .75rem;">
                            <i class='far fa-trash-alt remove-autorecog templates' data-idx="{{idx}}"></i>
                            <span class='aaToggle02'>{{localize 'AUTOANIM.delete'}}</span>
                        </div>
                    </div>
                </div>
            </div>
            {{/if}}
            {{#unless ( lookup (lookup ../settings.aaAutorec.templates idx) 'hidden' ) }}
            <div class='flexcol'>
                <div class='form-group'>
                    <div class='form-fields'>
                        <input type='checkbox' class='hideme' name='aaAutorec.templates.{{idx}}.hidden' {{checked
                            (lookup (lookup ../settings.aaAutorec.templates idx) 'hidden' ) }} style="display:none">
                        <div class="aaToolTip" style="max-width: 1.5rem;margin-left: .75rem;"><i {{#if ( lookup (lookup
                                ../settings.aaAutorec.templates idx) 'hidden' ) }} class="fas fa-plus collapse-button"
                                {{/if}} {{#unless ( lookup (lookup ../settings.aaAutorec.templates idx) 'hidden' ) }}
                                class="fas fa-minus collapse-button" {{/unless}}></i>
                            <span class='aaToggle01'>
                                {{#if (lookup (lookup ../settings.aaAutorec.templates idx) 'hidden')}}
                                {{localize 'AUTOANIM.expand'}}
                                {{/if}}
                                {{#unless (lookup (lookup ../settings.aaAutorec.templates idx) 'hidden')}}
                                {{localize 'AUTOANIM.collapse'}}
                                {{/unless}}
                            </span>
                        </div>
                        <div class="aaToolTip" style="max-width: 1.5rem;margin-left: .75rem;"><i
                                class='far fa-clone duplicate-templates' data-idx="{{idx}}"></i>
                            <span class='aaToggle01'>{{localize 'AUTOANIM.duplicate'}}</span>
                        </div>
                        <input type='text' name="aaAutorec.templates.{{idx}}.name"
                            placeholder="{{localize 'AUTOANIM.itemName'}}" class='auto-name'
                            value="{{lookup (lookup ../settings.aaAutorec.templates idx) 'name'}}" />
                        <input type='checkbox' class='showSound' name='aaAutorec.templates.{{idx}}.soundOnly.enable'
                            {{checked ( lookup ( lookup (lookup ../settings.aaAutorec.templates idx) 'soundOnly'
                            ) 'enable' ) }} style="display:none">
                        <div class="aaToolTip" style="max-width: 1.5rem;margin-left: .75rem;">
                            <i class='fas fa-music fa-lg showSoundOnly' data-idx="{{idx}}"></i>
                            <span class='aaToggle02'>{{localize 'AUTOANIM.sound'}} {{localize 'AUTOANIM.only'}}</span>
                        </div>
                        <input type='checkbox' class='showMacro' name='aaAutorec.templates.{{idx}}.macro.enable'
                            {{checked ( lookup (lookup (lookup ../settings.aaAutorec.templates idx) 'macro' ) 'enable'
                            )}} style="display:none">
                        <div class="aaToolTip" style="max-width: 1.5rem;margin-left: .75rem;">
                            <i class='far fa-keyboard fa-lg enableMacro' data-idx="{{idx}}"></i>
                            <span class='aaToggle02'>{{localize 'AUTOANIM.add'}} {{localize 'AUTOANIM.macro'}}</span>
                        </div>
                        <div class="aaToolTip" style="max-width: 1.5rem;margin-left: .75rem;">
                            <i class='far fa-trash-alt remove-autorecog templates' data-idx="{{idx}}"></i>
                            <span class='aaToggle02'>{{localize 'AUTOANIM.delete'}}</span>
                        </div>
                    </div>
                </div>
                {{#ifnoteq ( lookup ( lookup (lookup ../settings.aaAutorec.templates idx) 'macro' ) 'playWhen' ) '2' }}
                {{#unless ( lookup ( lookup (lookup ../settings.aaAutorec.templates idx) 'soundOnly' ) 'enable' ) }}
                <div class="aa-container">
                    <div class="option01">
                        <label for="aaAutorec.templates.{{idx}}.type">{{localize 'AUTOANIM.type'}}:
                            <select name="aaAutorec.templates.{{idx}}.type">
                                {{#select (lookup (lookup ../settings.aaAutorec.templates idx)
                                'type')}}
                                <option value=""></option>
                                <option value="cone">{{localize "AUTOANIM.cone"}}</option>
                                <option value="rect">{{localize "AUTOANIM.square"}}</option>
                                <option value="circle">{{localize "AUTOANIM.circle"}}</option>
                                <option value="ray">{{localize "AUTOANIM.ray"}}</option>
                                {{/select}}
                            </select>
                        </label>
                    </div>
                    {{#unless (lookup (lookup ../settings.aaAutorec.templates idx) 'custom')}}
                    <div class="option02">
                        <div class='animation-choice'>
                            <label for="aaAutorec.templates.{{idx}}.animation">{{localize
                                'AUTOANIM.animation'}}:
                                <select name="aaAutorec.templates.{{idx}}.animation">
                                    {{#select (lookup (lookup ../settings.aaAutorec.templates idx)
                                    'animation')}}
                                    {{#ifEquals (lookup (lookup ../settings.aaAutorec.templates idx) 'type')
                                    'circle'}}
                                    {{#each ../templateCircle as |name key|}}
                                    <option value="{{key}}">{{name}}</option>
                                    {{/each}}
                                    {{/ifEquals}}

                                    {{#ifEquals (lookup (lookup ../settings.aaAutorec.templates idx) 'type')
                                    'cone'}}
                                    {{#each ../templateCone as |name key|}}
                                    <option value="{{key}}">{{name}}</option>
                                    {{/each}}
                                    {{/ifEquals}}

                                    {{#ifEquals (lookup (lookup ../settings.aaAutorec.templates idx) 'type')
                                    'rect'}}
                                    {{#each ../templateRect as |name key|}}
                                    <option value="{{key}}">{{name}}</option>
                                    {{/each}}
                                    {{/ifEquals}}

                                    {{#ifEquals (lookup (lookup ../settings.aaAutorec.templates idx) 'type')
                                    'ray'}}
                                    {{#each ../templateRay as |name key|}}
                                    <option value="{{key}}">{{name}}</option>
                                    {{/each}}
                                    {{/ifEquals}}
                                    {{/select}}
                                </select>
                            </label>
                        </div>
                    </div>
                    <div class="option03">
                        <label for="aaAutorec.templates.{{idx}}.variant">{{localize 'AUTOANIM.variant'}}:
                            <select name="aaAutorec.templates.{{idx}}.variant" sytle="width:5em">
                                {{#select (lookup (lookup ../settings.aaAutorec.templates idx) 'variant')}}
                                <option value=""> </option>
                                {{#each (lookup (lookup ../variants 'static') (lookup (lookup
                                ../settings.aaAutorec.templates idx) 'animation')) as |name key|}}
                                <option value="{{key}}">{{name}}</option>
                                {{/each}}
                                {{/select}}
                            </select>
                        </label>
                    </div>
                    <div class="option04">
                        <label for="aaAutorec.templates.{{idx}}.color">{{localize 'AUTOANIM.color'}}:
                            <select name="aaAutorec.templates.{{idx}}.color">
                                {{#select (lookup (lookup ../settings.aaAutorec.templates idx) 'color')}}
                                <option value=""> </option>
                                {{#each (lookup (lookup (lookup ../colors 'static') (lookup (lookup
                                ../settings.aaAutorec.templates idx) 'animation')) (lookup (lookup
                                ../settings.aaAutorec.templates idx) 'variant')) as |name key|}}
                                <option value="{{key}}">{{name}}</option>
                                {{/each}}
                                {{/select}}
                            </select>
                        </label>
                    </div>
                    {{/unless}}
                    <div class="option05">
                        <div class="autorec-menu-options">
                            <label>{{localize 'AUTOANIM.repeat'}}:
                                <input type="Number" name="aaAutorec.templates.{{idx}}.repeat"
                                    value="{{lookup (lookup ../settings.aaAutorec.templates idx) 'repeat'}}"
                                    data-dtype="Number" placeholder=1>
                            </label>
                        </div>
                    </div>
                    <div class="option06">
                        <div class="autorec-menu-options">
                            <label>{{localize 'AUTOANIM.delayMS'}}:
                                <input type="Number" name="aaAutorec.templates.{{idx}}.delay"
                                    value="{{lookup (lookup ../settings.aaAutorec.templates idx) 'delay'}}"
                                    data-dtype="Number" placeholder=250>
                            </label>
                        </div>
                    </div>
                    <div class="option07 autorec-menu-options">
                        <label>{{localize "AUTOANIM.scale"}} X</label>
                        <input type="Number" name="aaAutorec.templates.{{idx}}.scaleX"
                            value="{{lookup (lookup ../settings.aaAutorec.templates idx) 'scaleX'}}" data-dtype="Number"
                            placeholder=1>
                    </div>
                    <div class="option08 autorec-menu-options">
                        <label>{{localize "AUTOANIM.scale"}} Y</label>
                        <input type="Number" name="aaAutorec.templates.{{idx}}.scaleY"
                            value="{{lookup (lookup ../settings.aaAutorec.templates idx) 'scaleY'}}" data-dtype="Number"
                            placeholder=1>
                    </div>
                    <div class="option08" style='grid-column: 4 / 5; grid-row: 3 / 4'>
                        <div class="autorec-menu-options">
                            <div class='form-group'>
                                <label>{{localize 'AUTOANIM.below'}}: </label>
                                <input type='checkbox' name='aaAutorec.templates.{{idx}}.below' {{checked (lookup
                                    (lookup ../settings.aaAutorec.templates idx) 'below' ) }}>
                            </div>
                        </div>
                    </div>
                    <div style='grid-column: 1 / 2; grid-row: 4 / 5'>
                        <div class="autorec-menu-options">
                            <div class='form-group'>
                                <label>{{localize 'AUTOANIM.custom'}}: </label>
                                <input type='checkbox' name='aaAutorec.templates.{{idx}}.custom' {{checked (lookup
                                    (lookup ../settings.aaAutorec.templates idx) 'custom' ) }}>
                            </div>
                        </div>
                    </div>
                    {{#if (lookup (lookup ../settings.aaAutorec.templates idx) 'custom')}}
                    <div style='grid-column: 2 / 5; grid-row: 4 / 5;width: 25em'>
                        <div class="form-group">
                            <input type="text" class="files" name="aaAutorec.templates.{{idx}}.customPath"
                                value="{{lookup (lookup ../settings.aaAutorec.templates idx) 'customPath'}}">
                            <button type="button" class="file-picker" data-type="image/video"
                                data-target="aaAutorec.templates.{{idx}}.customPath" tabindex="-1" title="Browse Files">
                                <i class="fas fa-file-video"></i>
                            </button>
                        </div>
                    </div>
                    {{/if}}
                    <div style='grid-column: 1 / 2; grid-row: 5 / 6'>
                        <div class="autorec-menu-options">
                            <label>{{localize 'AUTOANIM.opacity'}}:
                                <input type="Number" name="aaAutorec.templates.{{idx}}.opacity"
                                    value="{{lookup (lookup ../settings.aaAutorec.templates idx) 'opacity'}}"
                                    data-dtype="Number" placeholder=1>
                            </label>
                        </div>
                    </div>
                    <div style='grid-column: 2 / 3; grid-row: 5 / 6'>
                        <div class="autorec-menu-options">
                            <div class='form-group'>
                                <label>{{localize 'AUTOANIM.remove'}}: </label>
                                <input type='checkbox' name='aaAutorec.templates.{{idx}}.removeTemplate' {{checked
                                    (lookup (lookup ../settings.aaAutorec.templates idx) 'removeTemplate' ) }}>
                            </div>
                        </div>
                    </div>
                    <div style='grid-column: 1 / 2; grid-row: 7 / 8'>
                        <div class="autorec-menu-options">
                            <div class='form-group'>
                                <label>{{localize 'AUTOANIM.persistant'}}: </label>
                                <input type='checkbox' name='aaAutorec.templates.{{idx}}.persist' {{checked (lookup
                                    (lookup ../settings.aaAutorec.templates idx) 'persist' ) }}>
                            </div>
                        </div>
                    </div>
                    {{#if (lookup (lookup ../settings.aaAutorec.templates idx) 'persist')}}
                    {{#matchOverhead (lookup ../settings.aaAutorec.templates idx)}}
                    <div style='grid-column: 2 / 3; grid-row: 7 / 8'>
                        <label>Persistent Type</label>
                        <select name="aaAutorec.templates.{{idx}}.persistType">
                            {{#select (lookup (lookup ../settings.aaAutorec.templates idx) 'persistType')}}
                            <option value=""></option>
                            <option value="overheadtile">{{localize "AUTOANIM.overheadtile"}}</option>
                            <option value="groundtile">{{localize "AUTOANIM.groundtile"}}</option>
                            <option value="sequencerground">{{localize "AUTOANIM.sequencereffect"}}</option>
                            <option value="attachtemplate">{{localize "AUTOANIM.attachtotemplate"}}</option>
                            {{/select}}
                        </select>
                    </div>
                    {{/matchOverhead}}
                    {{#sequencerOnly (lookup ../settings.aaAutorec.templates idx)}}
                    <div style='grid-column: 2 / 3; grid-row: 7 / 8'>
                        <label>Persistent Type</label>
                        <select name="aaAutorec.templates.{{idx}}.persistType">
                            {{#select (lookup (lookup ../settings.aaAutorec.templates idx) 'persistType')}}
                            <option value=""></option>
                            <option value="sequencerground">{{localize "AUTOANIM.sequencereffect"}}</option>
                            <option value="attachtemplate">{{localize "AUTOANIM.attachtotemplate"}}</option>
                            {{/select}}
                        </select>
                    </div>
                    {{/sequencerOnly}}
                    {{/if}}
                    {{#ifEquals (lookup (lookup ../settings.aaAutorec.templates idx) 'persistType')
                    'overheadtile'}}
                    <div class='form-group' style='grid-column: 1 / 3; grid-row: 8 / 9;'>
                        <label>{{localize "AUTOANIM.occlusionMode"}}</label>
                        <select name="aaAutorec.templates.{{idx}}.occlusionMode">
                            {{#select (lookup (lookup ../settings.aaAutorec.templates idx)
                            'occlusionMode')}}
                            <option value="3">{{localize "AUTOANIM.occlusion03"}}</option>
                            <option value="1">{{localize "AUTOANIM.occlusion01"}}</option>
                            <option value="2">{{localize "AUTOANIM.occlusion02"}}</option>
                            <option value="0">{{localize "AUTOANIM.occlusion00"}}</option>
                            {{/select}}
                        </select>
                    </div>
                    <div class="form-group" style='grid-column: 3 / 5; grid-row: 8 / 9;'>
                        <label>{{localize "AUTOANIM.occlusionAlpha"}}</label>
                        <div class="form-fields">
                            <input type="range" name="aaAutorec.templates.{{idx}}.occlusionAlpha"
                                value="{{lookup (lookup ../settings.aaAutorec.templates idx) 'occlusionAlpha'}}" min="0"
                                max="1" step="0.05">
                            <span class="range-value">{{occlusionAlpha}}</span>
                        </div>
                    </div>
                    {{/ifEquals}}
                    <div class='form-group'
                        style='padding-top: 5px;padding-bottom: 4px;grid-column: 1 / 2; grid-row: 9 / 10'>
                        <label>{{localize "AUTOANIM.sound"}}</label>
                        <input type="checkbox" name="aaAutorec.templates.{{idx}}.audio.a01.enable" {{checked (lookup
                            (lookup (lookup (lookup ../settings.aaAutorec.templates idx) 'audio' ) 'a01' ) 'enable' )}}>
                    </div>
                    {{#if (lookup (lookup (lookup (lookup ../settings.aaAutorec.templates idx) 'audio' )
                    'a01' )
                    'enable' )}}
                    <!--Explosion Audio filePicker and Text Input-->
                    <div class='form-group' style='grid-column: 2 / 5;grid-row: 9 / 10'>
                        <input style='width: 25em' type="text" class="files"
                            name="aaAutorec.templates.{{idx}}.audio.a01.file"
                            value="{{lookup (lookup (lookup (lookup ../settings.aaAutorec.templates idx) 'audio') 'a01') 'file'}}">
                        <button type="button" class="file-picker" data-type="audio"
                            data-target="aaAutorec.templates.{{idx}}.audio.a01.file" tabindex="-1" title="Browse Files">
                            <i class="fas fa-music"></i>
                        </button>
                    </div>
                    <!--Explosion Audio Delay-->
                    <div style='grid-column: 4 / 5;grid-row: 10 / 11; padding-bottom: 1em'>
                        <label>{{localize "AUTOANIM.delay"}}</label>
                        <input type="Number" name="aaAutorec.templates.{{idx}}.audio.a01.delay" min="0"
                            value="{{lookup (lookup (lookup (lookup ../settings.aaAutorec.templates idx) 'audio') 'a01') 'delay'}}"
                            style='width: 3em' placeholder=0>
                    </div>
                    <!--Explosion Audio Volume-->
                    <div style='grid-column: 3 / 4;grid-row: 10 / 11; padding-bottom: 1em'>
                        <label>{{localize "AUTOANIM.volume"}}</label>
                        <input type="Number" name="aaAutorec.templates.{{idx}}.audio.a01.volume" min="0" max="1"
                            step="0.01" style='width: 3em'
                            value="{{lookup (lookup (lookup (lookup ../settings.aaAutorec.templates idx) 'audio') 'a01') 'volume'}}"
                            placeholder=0.5>
                    </div>
                    {{/if}}
                </div>
                {{/unless}}
                {{/ifnoteq}}
                {{#if (lookup (lookup (lookup ../settings.aaAutorec.templates idx) 'soundOnly' ) 'enable' ) }}
                <div style="padding:3px"></div>
                <div class='flexrow text-green'>
                    <label><strong>{{localize "AUTOANIM.sound"}} {{localize "AUTOANIM.only"}}</strong></label>
                </div>
                <div class="aa-item-container">
                    <!--Explosion Audio filePicker and Text Input-->
                    <div class='form-group' style='grid-column: 2 / 5;grid-row: 4 / 5'>
                        <input style='width: 25em' type="text" class="files"
                            name="aaAutorec.templates.{{idx}}.soundOnly.file"
                            value="{{lookup (lookup (lookup ../settings.aaAutorec.templates idx) 'soundOnly') 'file'}}">
                        <button type="button" class="file-picker" data-type="audio"
                            data-target="aaAutorec.templates.{{idx}}.soundOnly.file" tabindex="-1" title="Browse Files">
                            <i class="fas fa-music"></i>
                        </button>
                    </div>
                    <!--Explosion Audio Delay-->
                    <div style='grid-column: 4 / 5;grid-row: 5 / 6; padding-bottom: 1em'>
                        <label>{{localize "AUTOANIM.delay"}}</label>
                        <input type="Number" name="aaAutorec.templates.{{idx}}.soundOnly.delay" min="0"
                            value="{{lookup (lookup (lookup ../settings.aaAutorec.templates idx) 'soundOnly') 'delay'}}"
                            style='width: 3em' placeholder=0>
                    </div>
                    <!--Explosion Audio Volume-->
                    <div style='grid-column: 3 / 4;grid-row: 5 / 6; padding-bottom: 1em'>
                        <label>{{localize "AUTOANIM.volume"}}</label>
                        <input type="Number" name="aaAutorec.templates.{{idx}}.soundOnly.volume" min="0" max="1"
                            step="0.01" style='width: 3em'
                            value="{{lookup (lookup (lookup ../settings.aaAutorec.templates idx) 'soundOnly') 'volume'}}"
                            placeholder=0.5>
                    </div>
                </div>
                {{/if}}
                <div style="padding:3px"></div>
                <div {{#unless (lookup ( lookup (lookup ../settings.aaAutorec.templates idx) 'macro' ) 'enable' )}}
                    style="display:none" {{/unless}}>
                    <div class='flexrow text-green'>
                        <label><strong>{{localize "AUTOANIM.macro"}}</strong></label>
                    </div>
                    <div class="aa-item-container">
                        <!--Choose how/when to Play the Macro-->
                        <div class='form-group' style='grid-column: 1 / 3; grid-row: 2 / 3;'>
                            <label style='font-weight: bold;'>When to Play
                                <select name="aaAutorec.templates.{{idx}}.macro.playWhen">
                                    {{#select (lookup (lookup (lookup ../settings.aaAutorec.templates idx) 'macro')
                                    'playWhen' )}}
                                    <option value="0">{{localize 'AUTOANIM.macroconcurrent'}}</option>
                                    <option value="1">{{localize 'AUTOANIM.awaitmacro'}}</option>
                                    <option value="2">{{localize 'AUTOANIM.macroonly'}}</option>
                                    {{/select}}
                                </select> </label>
                        </div>
                        <!--Macro Name input Field-->
                        <div class='form-group' style='grid-column: 3 / 5;grid-row: 2 / 3'>
                            <label style='font-weight: bold;'>{{localize 'AUTOANIM.macro'}} {{localize
                                'AUTOANIM.name'}}</label>
                            <input style='width: 10em' type="text" name="aaAutorec.templates.{{idx}}.macro.name"
                                value="{{lookup (lookup (lookup ../settings.aaAutorec.templates idx) 'macro') 'name'}}">
                        </div>
                        <div style='grid-row: 3 / 4; grid-column: 1 / 2;text-align: right; font-weight: bold;'>
                            {{localize "AUTOANIM.args"}}
                        </div>
                        <div class='form-group' style='grid-column: 2 / 5;grid-row: 3 / 4;text-align: left;'>
                            <input style='width: 35em' type="text" name="aaAutorec.templates.{{idx}}.macro.args"
                                value="{{lookup (lookup (lookup ../settings.aaAutorec.templates idx) 'macro') 'args'}}">
                        </div>
                    </div>
                </div>
            </div>
            {{/unless}}
        </div>
    </div>
    {{/each}}
</div>
<footer class='sheet-footer flexrow add-templates-wrapper'>
    <button class='add-autorecog-templates'>
        <i class='far fa-plus-square'></i>{{localize 'AUTOANIM.addItem'}}
    </button>
</footer>